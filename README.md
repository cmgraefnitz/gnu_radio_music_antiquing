# The Problem: Antiquing Songs in GNU Radio
I will be attempting to implement filters, effects, and noise that will make a song sound like it is coming from a variety of different sources. I want the program to work with any audio file, so I will try my best not to hard code anything creating dependencies on the file I use. I plan to add functionalities to switch between 5 filter options: no filter, gramophone, telephone, AM radio, and FM radio. Additionally, there will be a option to add noise and a menu allowing the application of two different frequency moduling effects: wow and flutter. Lastly, I am going to try to translate the python code from the past assignments into existing GNU blocks and modules as a challenge for myself, rather than using just a couple custom python blocks to do everything.
## FIR Bandpass Filters
Instead of using four different filters simultaneously and switching between the output, I have used only one FIR filter with which the band-pass filter taps are dynamically changed from a dropdown menu in the GUI. At first I attempted using four separate filter taps, but this was far too intensive, so I created an additional variable that sets the low and high frequencies in the band-pass filter taps block.
## Adding White Noise
I originally wanted to add a feedback system that would always maintain a chosen SNR (default 10), but after some troubleshooting and reading more documentation I realized this may be an intensive task given that the signal would need to be probed to periodically update the RMS. So, instead, I decided upon a simpler approach: add a Gaussian noise source that is proportional to the audio signal with a DC offset. I debated whether to put the noise source before or after the filters and/or modulation. I tried adding it at the end and it didn't sound very good with the filtered options. Despite making the noise less audible, I decided to add it before the filters and modulation. I might try to find a better solution later, but it works for now.
## Wow Effect
In Python, the Wow effect is achieved by frequency modulating a signal with a low carrier frequency (0.5-6 Hz) using a frequency deviation derived from the wow depth. In a past assignment, we did this by warping a time vector and interpolating the resulting signal with the desired frequency deviations emulating the wow effect. However, because GNU radio mainly uses streams of data to make computations in real time, I used a fractional resampling block driven by a low frequency oscillator (1.3 Hz by default) with an amplitude equal to the wow depth (1/120 by default).
## Flutter Effect
The flutter effect was achieved the same way the wow effect was, but with different parameters, as flutter occurs at a higher frequency than wow (about 6-100 Hz).
## Visualization
I have added another decimating FIR filter before the frequency, time, and waterfall sinks in an effort to reduce the computational intensity of the GUI.  
# Usage
To use this program to antique your own music you must:
    1) Get a .wav file. There is one provided in this repostitory as an example named "Tomorrow_Is_Today_Billy_Joel.wav" that you may also use.
    2) Open the "ECSE_351_GNU_Radio_Project.grc" file after starting the GNU Radio companion. Find the block on the left of the screen named "Wav File Source" and open its properties window by double clicking. Here you can choose the location of your own file or the one I have provided in the GNU Radio folder.
    3) Change the samp_rate variable in the left corner to match the file you have chosen. It is 48k by default.
    4) Execute the flow graph (F5 or the button on the toolbar).
    5) The song should immediately start playing. Once the GUI is open you will see two drop down menus beside four sliders. The first dropdown menu allows you to dynamically switch between filtering presets. The dropdown below is for applying the 'wow' or 'flutter' frequency modulating effect. There are two sets of two sliders to control the modulation depth and frequency of the wow and flutter effects. Go ahead and play around with them and use different combinations of noise, filters, and modulating effects.
    6) The waterfall graphic is not enbled by default to keep the program relatively lightweight. But you can enable it before executing the flow graph by clicking on it and pressing the E key on the keyboard.